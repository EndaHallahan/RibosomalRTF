const RibosomalRTF = require("../index");
const util = require('util');
const { performance } = require('perf_hooks');

const table = `{{\\trowd \\trgaph115\\trleft388\\trbrdrt\\brdrs\\brdrw15\\brdrcf11 \\trbrdrl\\brdrs\\brdrw15\\brdrcf11 \\trbrdrb\\brdrs\\brdrw15\\brdrcf11 \\trbrdrr\\brdrs\\brdrw15\\brdrcf11 \r\n\\trbrdrh\\brdrs\\brdrw15\\brdrcf11 \\trbrdrv\\brdrs\\brdrw15\\brdrcf11 \r\n\\tphmrg\\tposxc\\tposyc\\tdfrmtxtLeft187\\tdfrmtxtRight187\\trftsWidth1\\trftsWidthB3\\trwWidthB504\\trftsWidthA3\\trautofit1\\trspdl14\\trspdt14\\trspdb14\\trspdr14\\trspdfl3\\trspdft3\\trspdfb3\\trspdfr3\\trpaddl115\\trpaddr115\\trpaddfl3\\trpaddfr3 \\clvertalc\\clbrdrt\r\n\\brdrs\\brdrw15\\brdrcf11 \\clbrdrl\\brdrs\\brdrw15\\brdrcf11 \\clbrdrb\\brdrs\\brdrw15\\brdrcf11 \\clbrdrr\\brdrs\\brdrw15\\brdrcf11 \\clcbpat17\\cltxlrtb\\clftsWidth3\\clwWidth4644 \\cellx5074\\pard\\plain \r\n\\qc \\li0\\ri0\\widctlpar\\intbl\\phmrg\\posxc\\posyc\\dxfrtext187\\dfrmtxtx187\\dfrmtxty0\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0 \\fs24\\lang1033\\langfe2052\\loch\\af0\\hich\\af0\\dbch\\af17\\cgrid\\langnp1033\\langfenp2052 {\\hich\\af0\\dbch\\af17\\loch\\f0 CELL ONE\r\n\\par }\\pard \\qc \\li0\\ri0\\widctlpar\\intbl\\phmrg\\posxc\\posyc\\dxfrtext187\\dfrmtxtx187\\dfrmtxty0\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0\\itap2 {\\hich\\af0\\dbch\\af17\\loch\\f0 NESTED TABLE\\nestcell{\\nonesttables\r\n\\par }}\\pard \\ql \\li0\\ri0\\widctlpar\\intbl\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0\\itap2 {{\\*\\nesttableprops\\trowd \\trgaph108\\trleft8\\trbrdrt\\brdrs\\brdrw15\\brdrcf11 \\trbrdrl\\brdrs\\brdrw15\\brdrcf11 \\trbrdrb\\brdrs\\brdrw15\\brdrcf11 \\trbrdrr\r\n\\brdrs\\brdrw15\\brdrcf11 \\trbrdrh\\brdrs\\brdrw15\\brdrcf11 \\trbrdrv\\brdrs\\brdrw15\\brdrcf11 \\trftsWidth1\\trautofit1\\trpaddl108\\trpaddr108\\trpaddfl3\\trpaddfr3 \\clvertalt\\clbrdrt\\brdrs\\brdrw15\\brdrcf11 \\clbrdrl\\brdrs\\brdrw15\\brdrcf11 \\clbrdrb\r\n\\brdrs\\brdrw15\\brdrcf11 \\clbrdrr\\brdrs\\brdrw15\\brdrcf11 \\cltxlrtb\\clftsWidth3\\clwWidth2340 \\cellx2348\\nestrow}{\\nonesttables\r\n\\par }}\\trowd \\trgaph115\\trleft388\\trbrdrt\\brdrs\\brdrw15\\brdrcf11 \\trbrdrl\\brdrs\\brdrw15\\brdrcf11 \\trbrdrb\\brdrs\\brdrw15\\brdrcf11 \\trbrdrr\\brdrs\\brdrw15\\brdrcf11 \\trbrdrh\\brdrs\\brdrw15\\brdrcf11 \\trbrdrv\\brdrs\\brdrw15\\brdrcf11 \r\n\\tphmrg\\tposxc\\tposyc\\tdfrmtxtLeft187\\tdfrmtxtRight187\\trftsWidth1\\trftsWidthB3\\trwWidthB504\\trftsWidthA3\\trautofit1\\trspdl14\\trspdt14\\trspdb14\\trspdr14\\trspdfl3\\trspdft3\\trspdfb3\\trspdfr3\\trpaddl115\\trpaddr115\\trpaddfl3\\trpaddfr3 \\clvertalc\\clbrdrt\r\n\\brdrs\\brdrw15\\brdrcf11 \\clbrdrl\\brdrs\\brdrw15\\brdrcf11 \\clbrdrb\\brdrs\\brdrw15\\brdrcf11 \\clbrdrr\\brdrs\\brdrw15\\brdrcf11 \\clcbpat17\\cltxlrtb\\clftsWidth3\\clwWidth4644 \\cellx5074\\pard \r\n\\qc \\li0\\ri0\\widctlpar\\intbl\\phmrg\\posxc\\posyc\\dxfrtext187\\dfrmtxtx187\\dfrmtxty0\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0 {\\cell }\\pard \\ql \\li0\\ri0\\widctlpar\\intbl\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0 {\\trowd \\trgaph115\\trleft388\\trbrdrt\r\n\\brdrs\\brdrw15\\brdrcf11 \\trbrdrl\\brdrs\\brdrw15\\brdrcf11 \\trbrdrb\\brdrs\\brdrw15\\brdrcf11 \\trbrdrr\\brdrs\\brdrw15\\brdrcf11 \\trbrdrh\\brdrs\\brdrw15\\brdrcf11 \\trbrdrv\\brdrs\\brdrw15\\brdrcf11 \r\n\\tphmrg\\tposxc\\tposyc\\tdfrmtxtLeft187\\tdfrmtxtRight187\\trftsWidth1\\trftsWidthB3\\trwWidthB504\\trftsWidthA3\\trautofit1\\trspdl14\\trspdt14\\trspdb14\\trspdr14\\trspdfl3\\trspdft3\\trspdfb3\\trspdfr3\\trpaddl115\\trpaddr115\\trpaddfl3\\trpaddfr3 \\clvertalc\\clbrdrt\r\n\\brdrs\\brdrw15\\brdrcf11 \\clbrdrl\\brdrs\\brdrw15\\brdrcf11 \\clbrdrb\\brdrs\\brdrw15\\brdrcf11 \\clbrdrr\\brdrs\\brdrw15\\brdrcf11 \\clcbpat17\\cltxlrtb\\clftsWidth3\\clwWidth4644 \\cellx5074\\row }\\trowd \\trgaph115\\trleft-158\\trbrdrt\\brdrs\\brdrw15\\brdrcf11 \\trbrdrl\r\n\\brdrs\\brdrw15\\brdrcf11 \\trbrdrb\\brdrs\\brdrw15\\brdrcf11 \\trbrdrr\\brdrs\\brdrw15\\brdrcf11 \\trbrdrh\\brdrs\\brdrw15\\brdrcf11 \\trbrdrv\\brdrs\\brdrw15\\brdrcf11 \r\n\\tphmrg\\tposxc\\tposyc\\tdfrmtxtLeft187\\tdfrmtxtRight187\\trftsWidth1\\trftsWidthB3\\trftsWidthA3\\trwWidthA900\\trautofit1\\trspdl14\\trspdt14\\trspdb14\\trspdr14\\trspdfl3\\trspdft3\\trspdfb3\\trspdfr3\\trpaddl115\\trpaddr115\\trpaddfl3\\trpaddfr3 \\clvertalt\\clbrdrt\r\n\\brdrs\\brdrw15\\brdrcf11 \\clbrdrl\\brdrs\\brdrw15\\brdrcf11 \\clbrdrb\\brdrs\\brdrw15\\brdrcf11 \\clbrdrr\\brdrs\\brdrw15\\brdrcf11 \\clcbpat17\\cltxlrtb\\clftsWidth3\\clwWidth4248 \\cellx4132\\pard \r\n\\ql \\li0\\ri0\\widctlpar\\intbl\\phmrg\\posxc\\posyc\\dxfrtext187\\dfrmtxtx187\\dfrmtxty0\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0 {\\hich\\af0\\dbch\\af17\\loch\\f0 CELL TWO\\cell }\\pard \\ql \\li0\\ri0\\widctlpar\\intbl\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0 {\r\n\\trowd \\trgaph115\\trleft-158\\trbrdrt\\brdrs\\brdrw15\\brdrcf11 \\trbrdrl\\brdrs\\brdrw15\\brdrcf11 \\trbrdrb\\brdrs\\brdrw15\\brdrcf11 \\trbrdrr\\brdrs\\brdrw15\\brdrcf11 \\trbrdrh\\brdrs\\brdrw15\\brdrcf11 \\trbrdrv\\brdrs\\brdrw15\\brdrcf11 \r\n\\tphmrg\\tposxc\\tposyc\\tdfrmtxtLeft187\\tdfrmtxtRight187\\trftsWidth1\\trftsWidthB3\\trftsWidthA3\\trwWidthA900\\trautofit1\\trspdl14\\trspdt14\\trspdb14\\trspdr14\\trspdfl3\\trspdft3\\trspdfb3\\trspdfr3\\trpaddl115\\trpaddr115\\trpaddfl3\\trpaddfr3 \\clvertalt\\clbrdrt\r\n\\brdrs\\brdrw15\\brdrcf11 \\clbrdrl\\brdrs\\brdrw15\\brdrcf11 \\clbrdrb\\brdrs\\brdrw15\\brdrcf11 \\clbrdrr\\brdrs\\brdrw15\\brdrcf11 \\clcbpat17\\cltxlrtb\\clftsWidth3\\clwWidth4248 \\cellx4132\\row}}}
`

const restrictions = `{\\*\\latentstyles\\lsdstimax156\\lsdlockeddef1{\\lsdlockedexcept Normal;heading 1;heading 2;heading 3;Default Paragraph Font;HTML Top of Form;HTML Bottom of Form;Normal Table;No List;}}`;

function test() {
	const start = performance.now();
	RibosomalRTF.parseFile("test/234.rtf").then(obj => {
		const timeElapsed = performance.now() - start;
		console.log(util.inspect(obj,{depth:null,colors:true,maxArrayLength:null,compact:false}));
		console.log("(" + timeElapsed + " milliseconds)");	
	});
	/*RibosomalRTF.parseString(restrictions).then(obj => {
		const timeElapsed = performance.now() - start;
		console.log(util.inspect(obj.tables,{depth:null,colors:true,maxArrayLength:null,compact:false}));
		console.log("(" + timeElapsed + " milliseconds)");	
	});*/
}

test();
